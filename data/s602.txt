<div class="toc hide">

<a href="#solution">Solution</a>
<a href="#approach-i-using-flow-control-statement-case-accepted">Approach I: Using flow control statement CASE [Accepted]</a></li>
<a href="#approach-ii-using-bit-manipulation-and-coalesce-accepted">Approach II: Using bit manipulation and COALESCE() [Accepted]</a></li>
</ul>
</li>
</ul>
</div>
Solution</h2>

<h4 id="approach-i-using-flow-control-statement-case-accepted">Approach I: Using flow control statement CASE</code> [Accepted]</h4>
Algorithm</strong></p>
For students with odd id, the new id is (id+1) after switch unless it is the last seat. And for students with even id, the new id is (id-1). In order to know how many seats in total, we can use a subquery:</p>
</span>SELECT</span>
    COUNT</span>(</span>*</span>)</span> AS</span> counts</span>
FROM</span>
    seat</span>
</pre></div>


Then, we can use the CASE</code> statement and MOD()</code> function to alter the seat id of each student.</p>
MySQL</strong></p>
</span>SELECT</span>
    (</span>CASE</span>
        WHEN</span> MOD</span>(</span>id</span>,</span> 2</span>)</span> !=</span> 0</span> AND</span> counts</span> !=</span> id</span> THEN</span> id</span> +</span> 1</span>
        WHEN</span> MOD</span>(</span>id</span>,</span> 2</span>)</span> !=</span> 0</span> AND</span> counts</span> =</span> id</span> THEN</span> id</span>
        ELSE</span> id</span> -</span> 1</span>
    END</span>)</span> AS</span> id</span>,</span>
    student</span>
FROM</span>
    seat</span>,</span>
    (</span>SELECT</span>
        COUNT</span>(</span>*</span>)</span> AS</span> counts</span>
    FROM</span>
        seat</span>)</span> AS</span> seat_counts</span>
ORDER</span> BY</span> id</span> ASC</span>;</span>
</pre></div>


<h4 id="approach-ii-using-bit-manipulation-and-coalesce-accepted">Approach II: Using bit manipulation and COALESCE()</code> [Accepted]</h4>
Algorithm</strong></p>
Bit manipulation expression (id+1)^1-1</code> can calculate the new id after switch.</p>
</span>SELECT</span> id</span>,</span> (</span>id</span>+</span>1</span>)</span>^</span>1</span>-</span>1</span>,</span> student</span> FROM</span> seat</span>;</span>
</pre></div>


</span>| id | (id+1)^1-1 | student |
|----|------------|---------|
| 1  | 2          | Abbot   |
| 2  | 1          | Doris   |
| 3  | 4          | Emerson |
| 4  | 3          | Green   |
| 5  | 6          | Jeames  |
</pre></div>


Then, we can make a temp table and join seat with this table like below.</p>
</span>SELECT</span>
    *</span>
FROM</span>
    seat</span> s1</span>
        LEFT</span> JOIN</span>
    seat</span> s2</span> ON</span> (</span>s1</span>.</span>id</span>+</span>1</span>)</span>^</span>1</span>-</span>1</span> =</span> s2</span>.</span>id</span>
ORDER</span> BY</span> s1</span>.</span>id</span>;</span>
</pre></div>


</span>| id | student | id | student |
|----|---------|----|---------|
| 1  | Abbot   | 2  | Doris   |
| 2  | Doris   | 1  | Abbot   |
| 3  | Emerson | 4  | Green   |
| 4  | Green   | 3  | Emerson |
| 5  | Jeames  |    |         |
</pre></div>



Note:The first two columns are from s1 and the last two are from s2.</p>
</blockquote>
At last, we can output s1.id and s2.student. However, the s2.student is NULL for seat id '5' but s1.student is right. Thus, we we can use function <a href="https://dev.mysql.com/doc/refman/5.7/en/comparison-operators.html#function_coalesce">COALESCE()</code></a> to generate the correct output for the last record.</p>
MySQL</strong></p>
</span>SELECT</span>
    s1</span>.</span>id</span>,</span> COALESCE</span>(</span>s2</span>.</span>student</span>,</span> s1</span>.</span>student</span>)</span> AS</span> student</span>
FROM</span>
    seat</span> s1</span>
        LEFT</span> JOIN</span>
    seat</span> s2</span> ON</span> ((</span>s1</span>.</span>id</span> +</span> 1</span>)</span> ^</span> 1</span>)</span> -</span> 1</span> =</span> s2</span>.</span>id</span>
ORDER</span> BY</span> s1</span>.</span>id</span>;</span>
</pre></div>



Note: This solution comes from <a href="https://discuss.leetcode.com/user/fangxiaofang">@FANGXIAOFANG</a>.</p>
</blockquote>